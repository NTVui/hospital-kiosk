extends ../../layouts/default.pug
include ../../mixins/filterStatus.pug
include ../../mixins/search.pug
include ../../mixins/pagination.pug
include ../../mixins/form-change-multi.pug
include ../../mixins/alert.pug
include ../../mixins/sort.pug

block main
    +alert-success(5000)
    +alert-error(5000)
    .page-header
        h1.page-title= pageTitle
        .card.mb-3  
            .card-header Bộ lọc và tìm kiếm 
                .card-body 
                    .row 
                        .col-6 
                            +filterStatus(filterStatus)
                        .col-6 
                            +search(keyword)

        .card.mb-3  
            .card-header Danh sách
                .card-body 
                    .row 
                        .col-8 
                            +form-change-multi(`${pathAdmin}/services/change-multi?_method=PATCH`, currentUrl)
                        .col-4
                            a(
                                href=`${pathAdmin}/services/create`
                                class="btn btn-outline-success"
                                ) + Thêm mới
            
        .card.mb-3  
            .card-header Sắp xếp 
                .card-body 
                    .row 
                        .col-4 
                            +sort()
            
        table.table.table-hover.table-bordered(checkbox-multi)
            thead
                tr
                    th
                        input(type='checkbox', name='checkall')
                    th STT
                    th Hình ảnh
                    th Tên dịch vụ
                    th Giá
                    th Vị trí
                    th Trạng thái
                    th Người tạo
                    th Người cập nhật
                    th Hành động
            tbody
                each item, index in services
                    tr
                        td 
                            input(type="checkbox", name="id", value=item.id)
                        td #{pagination.limitItems*(pagination.currentPage - 1)+(index+1)}
                        td 
                            img(src=item.thumbnail, alt=item.tenDichVu, width='100px')
                        td #{item.tenDichVu}
                        td #{item.price} 
                        td #{item.position}
                        td 
                            if item.status == 'active'
                                a.badge-status.badge-status--active(
                                    href="javascript:;",
                                    data-status="active",
                                    data-id=item._id,
                                    button-change-status
                                ) Hoạt động
                            else
                                a.badge-status.badge-status--inactive(
                                    href="javascript:;",
                                    data-status="inactive",
                                    data-id=item._id,
                                    button-change-status
                                ) Tạm ngưng
                        td Người tạo
                        td Người cập nhật
                        td
                            a.btn.btn-secondary.btn-sm(href=`${pathAdmin}/services/detail/${item._id}`) Chi tiết
                            a.btn.btn-warning.btn-sm(href=`${pathAdmin}/services/edit/${item._id}`) Sửa
                            button.btn.btn-danger.btn-sm(
                                button-delete,
                                data-id=item.id
                            ) Xóa
        +pagination(pagination)
        // Form ẩn để thay đổi trạng thái
        form#form-change-status(
            action='',
            method='POST',
            data-path=`${pathAdmin}/services/change-status`
        )


        form#form-delete-item(
            action='',
            method='POST',
            data-path=`${pathAdmin}/services/delete`
        )
    script(src='/admin/js/scripts.js') 