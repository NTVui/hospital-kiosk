extends ../../layouts/default.pug
include ../../mixins/alert.pug
include ../../mixins/progress-steps.pug

block main
  +progressbar(currentStep, 2)
  .container.my-5
    h2 üè• L·ª±a ch·ªçn d·ªãch v·ª• kh√°m

    form(method="POST", action=`/API/v1/kiosk/step-2/register-self/${cccd}`)
      // hidden input l∆∞u clinicId
      input(type="hidden", name="clinicId", id="clinicId")

      .grid
        each service in services
          if service.clinic_id
            label.card
              input(
                type="radio", 
                name="serviceId", 
                value=service._id, 
                data-clinic-id=service.clinic_id._id, 
                required
              )
              .card-content
                h4.card-title= `PK ${service.clinic_id.tenPhongKham} - ${service.tenDichVu}`
                p.card-subtitle= `Gi√°: ${service.price} VNƒê`
              
      button.btn.btn-primary(type="submit") ƒêƒÉng k√Ω kh√°m

  script.
    const form = document.querySelector("form");
    const radios = document.querySelectorAll("input[name='serviceId']");
    const hiddenClinicId = document.getElementById("clinicId");

    // G√°n clinicId ngay khi ch·ªçn radio
    radios.forEach(radio => {
      radio.addEventListener("change", function() {
        hiddenClinicId.value = this.dataset.clinicId;
      });
    });

    // ƒê·∫£m b·∫£o clinicId c√≥ tr∆∞·ªõc khi submit form
    form.addEventListener("submit", function(e) {
      const selected = document.querySelector("input[name='serviceId']:checked");
      if (selected) {
        hiddenClinicId.value = selected.dataset.clinicId;
      }
    });
